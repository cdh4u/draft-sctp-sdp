<?xml version="1.0"?>
<?rfc symrefs="yes"?>
<!DOCTYPE rfc SYSTEM "rfc2629.dtd">
<?rfc toc="yes" ?>
<?rfc compact="yes" ?>
<?rfc subcompact="no" ?>
<?rfc sortrefs="no" ?>
<rfc category="std" docName="draft-ietf-mmusic-sctp-sdp-18" ipr="trust200902">

<?xml-stylesheet type="text/xsl" href="rfc2629.xslt" ?>

<front>
   <title abbrev="SDP Offer/Answer For SCTP Over DTLS">
     Session Description Protocol (SDP) Offer/Answer Procedures
     For Stream Control Transmission Protocol (SCTP) over
     Datagram Transport Layer Security (DTLS) Transport.
   </title>

    <author initials="C." surname="Holmberg" fullname="Christer Holmberg">
		<organization>Ericsson</organization>
		<address>
			<postal>
				<street>Hirsalantie 11</street>
				<code>02420</code>
				<city>Jorvas</city>
				<country>Finland</country>
			</postal>
			<email>christer.holmberg@ericsson.com</email>
		</address>
    </author>

    <author fullname="Roman Shpount" initials="R.S." surname="Shpount">
        <organization abbrev="TurboBridge">TurboBridge</organization>
        <address>
            <postal>
                <street>4905 Del Ray Avenue, Suite 300</street>
                <city>Bethesda</city>
                <region>MD</region>
                <code>20814</code>
                <country>USA</country>
            </postal>
            <phone>+1 (240) 292-6632</phone>
            <email>rshpount@turbobridge.com</email>
        </address>
    </author>

    <author initials="S." surname="Loreto" fullname="Salvatore Loreto">
		<organization>Ericsson</organization>
		<address>
			<postal>
				<street>Hirsalantie 11</street>
				<code>02420</code>
				<city>Jorvas</city>
				<country>Finland</country>
			</postal>
			<email>Salvatore.Loreto@ericsson.com</email>
		</address>
    </author>

    <author initials="G." surname="Camarillo" fullname="Gonzalo Camarillo">
		<organization>Ericsson</organization>
		<address>
			<postal>
				<street>Hirsalantie 11</street>
				<code>02420</code>
				<city>Jorvas</city>
				<country>Finland</country>
			</postal>
			<email>Gonzalo.Camarillo@ericsson.com</email>
		</address>
    </author>

	<date year="2016"/>
	<area>RAI</area>
	<workgroup>MMUSIC</workgroup>
	<keyword>SCTP, SDP, DTLS</keyword>

  <abstract>
		<t>
			The Stream Control Transmission Protocol (SCTP) is a transport protocol
			used to establish associations between two endpoints.
      draft-ietf-tsvwg-sctp-dtls-encaps-09 specifies how SCTP can be used on
      top of the Datagram Transport Layer Security (DTLS) protocol, referred to
      as SCTP-over-DTLS.
		</t>
		<t>
      This specification defines the following new Session Description Protocol (SDP)
      protocol identifiers (proto values):'UDP/DTLS/SCTP' and 'TCP/DTLS/SCTP'. This
      specification also specifies how to use the new proto values with the
      SDP Offer/Answer mechanism for negotiating SCTP-over-DTLS associations.
		</t>
	</abstract>
</front>

<middle>
  <section title="Introduction">
		<t>
			SDP (Session Description Protocol) <xref target="RFC4566"/> provides a
			general-purpose format for describing multimedia sessions in announcements
			or invitations. TCP-Based Media Transport in the Session Description Protocol
			(SDP) <xref target="RFC4145"/> specifies a general mechanism for describing and
			establishing TCP <xref target="RFC0793"/> streams.
			Connection-Oriented Media Transport over the Transport Layer Security (TLS)
			Protocol in SDP <xref target="RFC4572"/> extends RFC4145 <xref target="RFC4145"/> for
			describing TCP-based media streams that are protected using TLS.
		</t>
		<t>
			The Stream Control Transmission Protocol (SCTP) <xref target="RFC4960"/> is a
			transport protocol used to establish associations between two endpoints.
		</t>
    <t>
			The Stream Control Transmission Protocol (SCTP) <xref target="RFC4960"/> is a
      transport protocol used to establish associations between two endpoints.
      <xref target="I-D.ietf-tsvwg-sctp-dtls-encaps"/> specifies how SCTP can be used on
      top of the Datagram Transport Layer Security (DTLS) protocol, referred to
      as SCTP-over-DTLS.
		</t>
    <t>
      This specification defines the following new Session Description Protocol (SDP)
      <xref target="RFC4566"/> protocol identifiers (proto values):'UDP/DTLS/SCTP'
      and 'TCP/DTLS/SCTP'. This specification also specifies how to use the new proto
      values with the SDP Offer/Answer mechanism <xref target="RFC3264"/> for negotiating
      SCTP-over-DTLS associations.
  	</t>
		<t>
			NOTE: TLS is designed to run on top of a byte-stream oriented
			transport protocol providing a reliable, in-sequence delivery like
			TCP. <xref target="RFC6083"/> presents serious limitations with transporting TLS
			on top of SCTP. Therefore, defining a mechanism to negotiate media streams
			transported using TLS on top of SCTP, i.e., 'SCTP/TLS', is outside the scope
			of this specification. In addition, defining a mechanism to negotiate non-protected
      SCTP associations is also outside the scope of this specification.
		</t>
	</section>

  <section title="Conventions">
  <t>
    The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
    "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
    document are to be interpreted as described in <xref target="RFC2119"></xref>.
  </t>
  </section>

	<section title="SCTP Terminology">
		<t>
			SCTP Association: A protocol relationship between SCTP endpoints,
			composed of the two SCTP endpoints and protocol state information
			including Verification Tags and the currently active set of
			Transmission Sequence Numbers (TSNs), etc. An association can be
			uniquely identified by the transport addresses used by the
			endpoints in the association.
		</t>
		<t>
			SCTP Stream: A unidirectional logical channel established from one to
			another associated SCTP endpoint, within which all user messages
			are delivered in sequence except for those submitted to the
			unordered delivery service.
		</t>
		<t>
			SCTP Transport address: A transport address is traditionally defined by
			a network-layer address, a transport-layer protocol, and a
			transport-layer port number. In the case of SCTP running over IP,
			a transport address is defined by the combination of an IP address
			and an SCTP port number (where SCTP is the transport protocol).
		</t>
    <t>
      SCTP-over-DTLS: SCTP used on top of DTLS, as specified in
      <xref target="I-D.ietf-tsvwg-sctp-dtls-encaps"/>.
    </t>
	</section>

	<section title="SDP Media Descriptions" anchor="m-line">
		<section title="General" anchor="m-line-gen">
			<t>
				This section defines the following new SDP Media Description (m- line)
				protocol identifiers (proto values) for describing an SCTP association:
				UDP/DTLS/SCTP' and 'TCP/DTLS/SCTP'. The section
				also describes how an m- line, associated with the proto values, is created.
			</t>
			<t>
				The following is the format for an 'm' line, as specified in RFC4566
				<xref target="RFC4566"/>:
			</t>
			<figure>
				<artwork><![CDATA[
    m=<media> <port> <proto> <fmt> ...
				]]></artwork>
			</figure>
      <t>
				The 'UDP/DTLS/SCTP' and 'TCP/DTLS/SCTP' proto values are similar to both
        the 'UDP' and 'TCP' proto values in that they only describe the transport-layer
        protocol and not the upper-layer protocol.
			</t>
			<t>
				NOTE: When the 'UDP/DTLS/SCTP' and 'TCP/DTLS/SCTP' proto values are used,
				the underlying transport protocol is respectively UDP and TCP; SCTP is
				carried on top of DTLS which is on top of those transport-layer protocols.
 			</t>
			<t>
				The m- line fmt value, identifying the application-layer protocol,
				MUST be registered by IANA.
			</t>
		</section>

		<section title="Protocol Identifiers" anchor="proto">
			<t>
				The new proto values are defined as below:
			</t>
			<t>
				<list style="symbols">
					<t>
						The 'UDP/DTLS/SCTP' proto value describes an SCTP association on top of
						a DTLS association on top of UDP, as defined in
						<xref target="sec-udp-dtls-sctp"/>.
					</t>
					<t>
						The 'TCP/DTLS/SCTP' proto value describes an SCTP association on top of
						a DTLS association on top of TCP, as defined in
						<xref target="sec-tcp-dtls-sctp"/>.
					</t>
				</list>
			</t>
		</section>

		<section title="Media Format Management" anchor="media">
			<t>
				<xref target="RFC4566"/> defines that specifications defining new proto values must
				define the rules by which their media format (fmt) namespace is managed.
				Use of an existing MIME subtype for the format is encouraged. If no MIME subtype
				exists, it is recommended that a suitable one is registered through the
				IETF process <xref target="RFC6838"/> <xref target="RFC4289"/> by production of, or
				reference to, a standards-track RFC that defines the transport protocol for the format.
			</t>
			<t>
				An m- line with a proto value of UDP/DTLS/SCTP' or 'TCP/DTLS/SCTP'
				always describe a single SCTP association.
			</t>
			<t>
				In addition, such m- line MUST further indicate the application-layer protocol
				using an 'fmt' identifier. There MUST be exactly one 'fmt' value per m- line associated
				with the proto values defined in this specification. The "fmt" namespace associated
				with those proto values describes the generic application usage of the entire SCTP
				association, including the associated SCTP streams.
			</t>
			<t>
				NOTE: A mechanism on how to describe, and manage, individual SCTP streams within an
				SCTP association, is outside the scope of this specification.
			</t>
		</section>

		<section title="Syntax" anchor="m-line-syn">
			<section title="General">
				<t>
					This section defines the ABNF <xref format="default" pageno="false"
					target="RFC5234"/> for the SDP media description when associated
					with any of the proto values defined in this document.
				</t>
				<t>
					This specification creates an IANA registry for 'association-usage' values.
				</t>
			</section>
			<section title="ABNF">
				<figure>
					<artwork><![CDATA[
    sctp-m-line = %x6d "="
     ("application" SP udp-port  SP "UDP/DTLS/SCTP" SP fmt CRLF) /
     ("application" SP tcp-port  SP "TCP/DTLS/SCTP" SP fmt CRLF)

    udp-port = port

    tcp-port = port

    fmt = association-usage

    association-usage = token

	token and port as defined in RFC4566
					]]></artwork>
				</figure>
			</section>
		</section>
		<section title="Example">
			<figure>
				<artwork><![CDATA[

 m=application 12345 UDP/DTLS/SCTP webrtc-datachannel
 a=max-message-size: 100000

 				]]></artwork>
			</figure>
		</section>
	</section>

	<section title="SDP 'sctp-port' Attribute" anchor="attr-sctp-port">
		<section title="General" anchor="attr-sctp-port-gen">
			<t>
				This section defines a new SDP media-level attribute, 'sctp-port'.
				The attribute can be associated with an SDP media description (m- line)
				with a 'UDP/DTLS/SCTP' or a 'TCP/DTLS/SCTP' proto value. In that case
				the m- line port value indicates the port of the underlying transport layer
				protocol (UDP or TCP), and the 'sctp-port' value indicates the SCTP port.
			</t>
			<t>
				No default value is defined for the SDP sctp-port attribute. Therefore, if
				the attribute is not present, the associated m- line MUST be considered invalid.
			</t>
			<t>
				Usage of the SDP 'sctp-port' attribute with other proto values
				is not specified, and MUST be discarded if received.
			</t>
		</section>
		<section title="Syntax" anchor="attr-sctp-port-syn">
			<t>
				The ABNF for the SDP 'sctp-port' attribute is:
			</t>
			<figure>
				<artwork><![CDATA[

    sctp-port-attr  =  "a=sctp-port:" port
    port            =  (1*5)DIGIT

    The SCTP port range is between 0 and 65535 (both included).
    Leading zeroes MUST NOT be used.

				]]></artwork>
			</figure>
		</section>
		<section title="Mux Category" anchor="attr-sctp-port-mux">
			<t>
				The mux category <xref target="I-D.ietf-mmusic-sdp-mux-attributes"/> for
				the SDP sctp-port' attribute is SPECIAL.  Usage of the attribute
				is only applicable when associated with 'UDP/DTLS/SCTP' and
				'TCP/DTLS/SCTP' proto value m- lines.
			</t>
			<t>
				As the usage of multiple SCTP associations on top of a single
				DTLS association is outside the scope of this specification,
				no mux rules are specified for the 'UDP/DTLS/SCTP' and
				'TCP/DTLS/SCTP' proto values. Future extensions, that define
				how to negotiate multiplexing of multiple SCTP associations of top of
				a single DTLS association, need to also define the mux rules for the
				attribute.
			</t>
		</section>
	</section>

	<section title="SDP 'max-message-size' Attribute" anchor="attr-max-message-size">
		<section title="General" anchor="attr-max-message-size-gen">
			<t>
				This section defines a new SDP media-level attribute, 'max-message-size'.
				The attribute can be associated with an m- line to indicate the maximum
				message size (indicated in bytes) that an SCTP endpoint is willing to
				receive on the SCTP association associated with the m- line. Different
				attribute values can be used in each direction.
			</t>
			<t>
				The remote peer MUST assume that larger messages will be rejected by the
				SCTP endpoint. SCTP endpoints need to decide on appropriate behavior in
				case a message that exceeds the maximum size needs to be sent.
			</t>
			<t>
				If the SDP 'max-message-size' attribute contains a maximum message size
				value of zero, it indicates the SCTP endpoint will handle messages of any size,
				subject to memory capacity etc.
			</t>
			<t>
				If the SDP 'max-message-size' attribute is not present, the default value is
				64K.
			</t>
			<t>
				NOTE: This specification only defines the usage of the SDP 'max-message-size'
				attribute when associated with an m- line containing one of the following proto
				values: 'UDP/DTLS/SCTP' or 'TCP/DTLS/SCTP'.
				Usage of the attribute with other proto values needs to be defined
				in a separate specification.
			</t>
		</section>
		<section title="Syntax" anchor="attr-max-message-size-syn">
			<t>
				The ABNF for the SDP 'max-message-size' attribute is:
			</t>
			<figure>
				<artwork><![CDATA[

    max-message-size-attr =  "a=max-message-size:" max-message-size
    max-message-size      =  1*40DIGIT

	  Leading zeroes MUST NOT be used.

				]]></artwork>
			</figure>
		</section>
		<section title="Mux Category" anchor="attr-max-message-size-mux">
			<t>
				The mux category for the SDP 'max-message-size' attribute
				is SPECIAL. The mux rules depends on the proto value of the
				associated m- line.
			</t>
			<t>
				As the usage of multiple SCTP associations on top of a single
				DTLS association is outside the scope of this specification,
				no mux rules are specified for the 'UDP/DTLS/SCTP' and
				'TCP/DTLS/SCTP' proto values.
			</t>
		</section>
	</section>

	<section title="UDP/DTLS/SCTP Transport Realization" anchor="sec-udp-dtls-sctp">
		<t>
			The UDP/DTLS/SCTP transport is realized as described below:
		</t>
		<t>
			<list style="symbols">
				<t>
						SCTP on top of DTLS is realized according to the procedures
						defined in <xref target="I-D.ietf-tsvwg-sctp-dtls-encaps"/>; and
				</t>
				<t>
						DTLS on top of UDP is realized according to the procedures in
						defined in <xref target="RFC6347"/>.
				</t>
			</list>
		</t>
		<t>
			NOTE: While <xref target="I-D.ietf-tsvwg-sctp-dtls-encaps"/> allows
			multiple SCTP associations on top of a single DTLS association,
			the procedures in this specification only supports the negotiation of a single
			SCTP association on top of any given DTLS association.
		</t>
	</section>

	<section title="TCP/DTLS/SCTP Transport Realization" anchor="sec-tcp-dtls-sctp">
		<t>
			The TCP/DTLS/SCTP transport is realized as described below:
		</t>
		<t>
			<list style="symbols">
				<t>
					SCTP on top of DTLS is realized according to the procedures
					defined in <xref target="I-D.ietf-tsvwg-sctp-dtls-encaps"/>; and
				</t>
				<t>
					DTLS on top of TCP is realized using the framing method defined in
					<xref target="RFC4571"/>, with DTLS packets being sent instead of
					RTP/RTCP packets, and SDP signaling according to the procedures
					defined in this specification.
				</t>
			</list>
		</t>
		<t>
			NOTE: DTLS on top of TCP, without using the framing method defined in
			<xref target="RFC4571"/> is outside the scope of this specification.
			A separate proto value would need to be registered for such
			transport realization.
		</t>
	</section>

  <section title="Association And Connection Management" anchor="sec-con-mgmt">
    <section title="General" anchor="sec-con-mgmt-gen">
      <t>
         This section describes how to mange an SCTP association, DTLS association and TCP connection
         using SDP attributes.
      </t>
      <t>
         In case of UDP/DTLS/SCTP and TCP/DTLS/SCTP the SCTP association, DTLS association
         and TCP connection are managed independetly for each other. An assocation/connection
         can be re-established without impacting other assocations/connections.
       </t>
       <t>
         The detailed SDP Offer/Answer <xref target="RFC3264"/> procedures for the SDP attributes
         are described in (<xref target="sec-sdp-oa"/>).
       </t>
    </section>
    <section title="SDP sendrecv/sendonly/recvonly/inactive Attribute" anchor="sec-con-mgmt-direction">
			<t>
				This specification does not define semantics for the SDP direction
				attributes <xref target="RFC4566"/>. Unless semantics of these
				attributes for an SCTP association usage have been defined, SDP direction
				attributes MUST be discarded if present.
			</t>
		</section>
    <section title="SCTP Association" anchor="sec-con-mgmt-sctp">
      <t>
        When an SCTP association is established/re-established, both SCTP endpoints
        MUST initiate the SCTP association (i.e. both SCTP endpoints take the 'active'
        role), and MUST use the same SCTP port as client port and server port (in order to
        prevent two separate SCTP associations from being established).
      </t>
      <t>
        As both SCTP endpoints take the 'active' role, this specification does not define
        usage of the SDP 'setup' attribute <xref target="RFC4145"/> for SCTP.
      </t>
      <t>
        NOTE: The procedure above is different from TCP, where one endpoint takes the 'active'
        role, the other endpoint takes the 'passive' role, and only the 'active' endpoint initiates
        the TCP connection <xref target="RFC4145"/>.
      </t>
      <t>
        NOTE: In case of SCTP-over-DTLS, when the SCTP association is established it is assumed
        that any NAT traversal procedures for the underlying transport protocol (UDP or TCP) has
        successfully been performed.
      </t>
      <t>
        Usage of the SDP 'connection' attribute <xref target="RFC4145"/> is not
        defined for SCTP. In order to trigger the re-establishment of an SCTP association,
        the SDP 'sctp-port' attribute (<xref target="attr-sctp-port"/>) is used to indicate
        a new (different than the ones currently used) SCTP ports.
      </t>
      <t>
        NOTE: This specification does not define procedures for re-establishing an SCTP association
        using the SCTP ports currently used for the SCTP association.
      </t>
    </section>
    <section title="DTLS Association (UDP/DTLS/SCTP And TCP/DTLS/SCTP)" anchor="sec-con-mgmt-dtls">
      <t>
        An DTLS association is managed according to the procedures in <xref target="I-D.ietf-mmusic-dtls-sdp"/>.
        Hence, the SDP 'setup' attribute is used to negotiate the (D)TLS roles ('client' and 'server')
        <xref target="RFC4572"/>.
      </t>
      <t>
        NOTE: The SDP 'setup' attribute is used both to negotiate both the DTLS roles and the
        TCP roles (<xref target="sec-con-mgmt-tcp"/>).
      </t>
      <t>
        NOTE: As described in <xref target="RFC5245"/>, if the Interactive Connectivity
        Establishment (ICE) mechanism <xref target="RFC5245"/> is used, all ICE
        candidates associated with an DTLS association as considered part of the same DTLS association.
        Thus, a switch from one candidate pair to another candidate pair will not trigger the establishment
        of a new DTLS association.
      </t>

    </section>
    <section title="TCP Connection (TCP/DTLS/SCTP)" anchor="sec-con-mgmt-tcp">
      <t>
        The TCP connection is managed according to the procedures in <xref target="RFC4145"/>. Hence,
        the SDP 'setup' attribute is used to negotiate the TCP roles ('active' and 'passive'), and
        the SDP 'connection' attribute is used to indicate whether to use an existing TCP connection,
        or create a new one. The SDP 'setup' attribute 'holdconn' value MUST NOT be used.
      </t>
      <t>
        NOTE: A change of the TCP roles will also trigger a re-establishment of the DTLS association, according
        to the procedures in <xref target="I-D.ietf-mmusic-dtls-sdp"/>.
      </t>
      <t>
        NOTE: As specified in <xref target="I-D.ietf-mmusic-dtls-sdp"/>, usage of the SDP 'setup' attribute
        'holdconn' value is not allowed. Therefore this specification also forbids usage of the attribute
        value for TCP, as DTLS is transported on top of TCP.
      </t>
    </section>
  </section>

	<section title="SDP Offer/Answer Procedures" anchor="sec-sdp-oa">
		<section title="General">
      <t>
				This section defines the SDP Offer/Answer <xref target="RFC3264"/>
				procedures for negotiating and establishing an SCTP-over-DTLS association.
        Unless explicitly stated, the procedures apply to both the
        'UDP/DTLS/SCTP' and 'TCP/DTLS/SCTP' m- line proto values.
			</t>
			<t>
        Each endpoint MUST associate one or more certificate fingerprints, using
        the SDP 'fingerprint' attribute with the m- line, following the procedures
        in <xref target="RFC4572"/> and <xref target="I-D.ietf-mmusic-4572-update"/>.
			</t>
			<t>
				The authentication certificates are interpreted and validated as
				defined in <xref target="RFC4572"/>. Self-signed certificates can
				be used securely, provided that the integrity of the SDP description
				is assured as defined in <xref target="RFC4572"/>.
			</t>
      <t>
        Each endpoint MUST associate an SDP 'dtls-id' attribute with the m- line,
        following the procedures in <xref target="I-D.ietf-mmusic-dtls-sdp"/>.
      </t>
		</section>
		<section title="Generating the Initial SDP Offer" anchor="sec-oa-initial-offer">
			<t>
				When the offerer creates an initial offer, the offerer:
			</t>
			<t>
				<list style="symbols">
					<t>
						MUST associate an SDP setup attribute, with an 'actpass' value, with the m- line;
					</t>
					<t>
						MUST associate an SDP 'sctp-port' attribute with the m- line;
					</t>
					<t>
						MUST, in the case of TCP/DTLS/SCTP, associate an SDP 'connection'
            attribute, with a 'new' attribute value, with the m- line; and
					</t>
					<t>
						MAY associate an SDP 'max-message-size' attribute
            (<xref target="attr-max-message-size" />) with the m- line.
					</t>
				</list>
			</t>
		</section>
		<section title="Generating the SDP Answer">
			<t>
				When the answerer receives an offer, which contains an m- line describing
				an SCTP association, if the answerer accepts the m- line it:
			</t>
			<t>
				<list style="symbols">
					<t>
						MUST insert a corresponding m- line in the answer, with an identical
						m- line proto value <xref target="RFC3264"/>;
					</t>
					<t>
						MUST associate an SDP 'setup' attribute, with an 'active' or 'passive'
            value, with the m- line;
					</t>
					<t>
						MUST associate an SDP 'sctp-port' attribute with the m- line; and
					</t>
					<t>
						MAY associate an SDP 'max-message-size' attribute
            (<xref target="attr-max-message-size" />)with the m- line. The
            attribute value in the answer is independent from the value
            (if present) in the corresponding m- line of the offer.
					</t>
				</list>
			</t>
			<t>
				Once the answerer has sent the answer, the answerer MUST, if an SCTP
        association has yet not been established, or if an existing SCTP
        association is to be re-established, initiate the establishement
        of the SCTP association.
			</t>
      <t>
        The answerer follows the procedures in <xref target="I-D.ietf-mmusic-dtls-sdp"/> regarding
        the establishment/re-establishemnt of the DTLS association.
      </t>
      <t>
        In the case of TCP/DTLS/SCTP, the answerer follows
        the procedures in <xref target="RFC4145"/> regarding
        the establishment/re-establishemnt of the TCP conection association.
      </t>
			<t>
				If the answerer does not accept the m- line in the offer, it MUST assign
        a zero port value to the corresponding m- line in the answer, following the
        procedures in <xref target="RFC3264"/>. In addition, the answerer MUST NOT
        initiate the establishment of an SCTP association, or a DTLS association,
        associated with the m- line.
			</t>

		</section>
		<section title="Offerer Processing of the SDP Answer">
			<t>
        Once the offerer has received the answer, which contains an m- line
        with a non-zero port value, the offerer MUST, if an SCTP
        association has yet not been established, or if an existing SCTP
        association is to be re-established, initiate the establishement
        of the SCTP association.
			</t>
      <t>
        The offerer follows the procedures in <xref target="I-D.ietf-mmusic-dtls-sdp"/> regarding
        the establishment/re-establishemnt of the DTLS association.
      </t>
      <t>
        In the case of TCP/DTLS/SCTP, the offerer follows
        the procedures in <xref target="RFC4145"/> regarding
        the establishment/re-establishemnt of the TCP conection association.
      </t>
			<t>
				If the m- line in the answer contains a zero port value, the offerer
        MUST NOT establish a TCP connection, an SCTP association, or a
        DTLS association, associated with the m- line.
			</t>
		</section>
		<section title="Modifying the Session">
			<t>
				When an offerer sends an updated offer, in order to modify a previously established
				SCTP association, it follows the procedures in <xref target="sec-oa-initial-offer" />,
				with the following exceptions:
			</t>
			<t>
				<list style="symbols">
					<t>
						Unless the offerer wants to re-establish an SCTP association, the offerer
						MUST associate an SDP 'sctp-port' attribute, with a new attribute value, with the
						m- line; and
					</t>
					<t>
						If the offerer wants to disable a previously established SCTP association, it MUST
						assign a zero port value to the m- line associated with the SCTP association, following
						the procedures in <xref target="RFC3264"/>.
					</t>
				</list>
			</t>
      <t>
        The offer follows the procedures in <xref target="I-D.ietf-mmusic-dtls-sdp"/> regarding
        the DTLS association impacts when modifying a session.
      </t>
      <t>
        In the case of TCP/DTLS/SCTP, the offer follows the procedures in
        <xref target="RFC4145"/> regarding the TCP connection impacts when
        modifying a session;
      </t>
    </section>
	</section>

	<section title="Multihoming Considerations">
		<t>
			SCTP supports multihoming. An SCTP endpoint is considered
			multihomed if it has more than one IP address on which SCTP
			can be used. An SCTP endpoint inform the remote peer about
			its IP addresses using the address parameters in the INIT/INIT-ACK
			chunk. Therefore, when SDP is used to describe an SCTP association,
			while the "c=" line contains the address which was used to negotiate
			the SCTP association, multihomed SCTP endpoints might end up using
			other IP addresses.
		</t>
		<t>
			If an endpoint removes the IP address <xref target="RFC5061"/> that
			it offered in the SDP "c=" line associated with the SCTP association,
			it MUST send a new Offer, in which the "c=" line contains an IP address
			which is valid within the SCTP association.
		</t>
		<t>
			NOTE: In some network environments, intermediaries performing gate-
			and firewall control using the address information in the SDP "c=" and
			"m=" lines to authorize media, and will not pass media sent using
			other addresses. In such network environments, if an SCTP endpoints
			wants to change the address information on which media is sent and
			received, it needs to send an updated Offer, in which the SDP "c="
			and "m=" lines contain the new address information.
		</t>
		<t>
			Multihoming is not supported when sending SCTP on top of DTLS,
			as DTLS does not expose address management of the underlying
			transport protocols (UDP or TCP) to its upper layer.
		</t>
	</section>

	<section title="NAT Considerations">
		<section title="General">
			<t>
				SCTP features not present in UDP or TCP, including the checksum
				(CRC32c) value calculated on the whole packet (rather than
				just the header), and multihoming, introduce new challenges
				for NAT traversal. <xref target="I-D.ietf-behave-sctpnat"/>
				defines an SCTP specific variant of NAT, which provides similar
				features of Network Address and Port Translation (NAPT).
			</t>
			<t>
				Current NATs typically do not support SCTP. <xref target="RFC6951"/>
				defines a mechanism for sending SCTP on top of UDP, which makes it
				possible to use SCTP with NATs and firewalls that do not support SCTP.
			</t>
		</section>
		<section title="ICE Considerations">
			<t>
				When the transport layer protocol is UDP (UDP/DTLS/SCTP), if ICE is used,
        the ICE procedures defined in <xref target="RFC5245"/> are used.
			</t>
			<t>
				When the transport layer protocol is TCP (TCP/DTLS/SCTP), if ICE is used,
        the ICE procedures defined in <xref target="RFC6544"/> are used.
			</t>
			<t>
				Implementations MUST treat all ICE candidate pairs associated with a
				an SCTP association on top of a DTLS association as part of the same
				DTLS association. Thus, there will only be one DTLS handshake even if
				there are multiple valid candidate pairs, and shifting from one candidate
				pair to another will not impact the DTLS association. If new candidates
				are added, they will also be part of the same DTLS association.
			</t>
      <t>
        When an SDP offer or answer is sent, the proto value MUST match the
        transport protocol associated with the default candidate. Hence, if UDP
        transport is used for the default candidiate the 'UDP/DTLS/SCTP'
        proto value MUST be used. If TCP transport is used for the default
        candidate the 'TCP/DTLS/SCTP' proto value MUST be used.
        However, if an endpoint switch between TCP-based and UDP-based candidates
        during a session the endpoint is not required to send an SDP offer in order
        to modify that proto value of the associated m- line.
      </t>
      <t>
        NOTE: The text in the paragraph above only applies when the usage of ICE
        has been negotiated. If ICE is not used, the proto value MUST always reflect
        the transport protocol used at any given time.
      </t>
		</section>
	</section>

	<section title="Examples">
		<section title="Establishment of UDP/DTLS/SCTP association">
			<figure>
				<artwork><![CDATA[

 SDP Offer:

    m=application 54111 UDP/DTLS/SCTP webrtc-datachannel
    c=IN IP4 192.0.2.1
    a=dtls-id:abc3dl
    a=setup:actpass
    a=sctp-port:5000
    a=max-message-size:100000

    - The offerer indicates that the usage of the
      UDP/DTLS/SCTP association will be as defined
      for the 'webrtc-datachannel' format value.
    - The offerer UDP port value is 54111.
    - The offerer SCTP port value is 5000.
    - The offerer indicates that it can take either the
      client or the server DTLS role.


 SDP Answer:

    m=application 64300 UDP/DTLS/SCTP webrtc-datachannel
    c=IN IP4 192.0.2.2
    a=dtls-id:ggr4rd
    a=setup:passive
    a=sctp-port:6000
    a=max-message-size:100000

    - The answerer UDP port value is 64300.
    - The answerer SCTP port value is 6000.
    - The answerer takes the server DTLS role.


								 ]]></artwork>
			</figure>
		</section>
	</section>

	<section title="Security Considerations">
		<t>
			<xref target="RFC4566"/> defines general SDP security considerations, while
			<xref target="RFC3264"/>, <xref target="RFC4145"/> and <xref target="RFC4572"/>
			define security considerations when using the SDP offer/answer mechanism
			to negotiate media streams.
		</t>
		<t>
			<xref target="RFC4960"/> defines general SCTP security considerations
      and <xref target="I-D.ietf-tsvwg-sctp-dtls-encaps"/> defines security
			considerations when using SCTP on top of DTLS.
		</t>
		<t>
			This specification does not introduce new security considerations in addition
			to those defined in the specifications listed above.
		</t>
	</section>

	<section title="IANA Considerations">
		<section title="New SDP proto values" anchor="iana-sdp-proto" toc="default">
			<t>
				[RFC EDITOR NOTE: Please replace RFCXXXX with the RFC number
				of this document.]
			</t>
			<t>
				This document updates the "Session Description Protocol (SDP) Parameters" registry,
				following the procedures in <xref target="RFC4566" pageno="false" format="default"/>,
				by adding the following values to the table in the SDP "proto" field registry:
			</t>
			<texttable anchor="table_SDP_proto_values" title='SDP "proto" field values'>
				<ttcol align='center'>Type</ttcol>
				<ttcol align='center'>SDP Name</ttcol>
				<ttcol align='center'>Reference</ttcol>
				<c>proto</c>
				<c>UDP/DTLS/SCTP</c>
				<c>[RFCXXXX]</c>
				<c>proto</c>
				<c>TCP/DTLS/SCTP</c>
				<c>[RFCXXXX]</c>
			</texttable>
		</section>

		<section title="New SDP Attributes" anchor="iana-sdp-attr" toc="default">
			<section title="sctp-port" anchor="iana-sdp-attr-sctp-port" toc="default">
				<t>
					[RFC EDITOR NOTE: Please replace RFCXXXX with the RFC number
					of this document.]
				</t>
				<t>
					This document defines a new SDP media-level attribute,'sctp-port', as follows:
				</t>
				<figure>
					<artwork align="left"><![CDATA[

	Attribute name:     sctp-port
	Type of attribute:  media
	Mux category:       SPECIAL
	Subject to charset: No
	Purpose:            Indicate the SCTP port value associated
                      with the SDP Media Description.
	Appropriate values: Integer
	Contact name:       Christer Holmberg
	Contact e-mail:     christer.holmberg@ericsson.com
	Reference:          RFCXXXX

					]]></artwork>
				</figure>
			</section>
			<section title="max-message-size" anchor="iana-sdp-attr-max-msg-size" toc="default">
				<t>
					[RFC EDITOR NOTE: Please replace RFCXXXX with the RFC number
					of this document.]
				</t>
				<t>
					This document defines a new SDP media-level attribute,'max-message-size', as follows:
				</t>
				<figure>
					<artwork align="left"><![CDATA[

	Attribute name:     max-message-size
	Type of attribute:  media
	Mux category:       SPECIAL
	Subject to charset: No
	Purpose:            Indicate the maximum message size that
                      an SCTP endpoint is willing to receive
                      on the SCTP association associated
                      with the SDP Media Description.
	Appropriate values: Integer
	Contact name:       Christer Holmberg
	Contact e-mail:     christer.holmberg@ericsson.com
	Reference:          RFCXXXX

					]]></artwork>
				</figure>
			</section>
		</section>

		<section title="association-usage Name Registry" anchor="iana-assusage-registry" toc="default">
			<t>
				[RFC EDITOR NOTE: Please replace RFCXXXX with the RFC number
				of this document.]
			</t>
			<t>
				This specification creates a new IANA registry, following the procedures in
				<xref target="RFC5226"/>, for the "fmt" namespace associated with the
				'UDP/DTLS/SCTP' and 'TCP/DTLS/SCTP' protocol identifiers.
				Each "fmt" value describes the usage of an entire SCTP association, including
				all SCTP streams associated with the SCTP association.
			</t>
			<t>
				NOTE: Usage indication of individual SCTP streams is outside the scope of this
				specification.
			</t>
			<t>
				The "fmt" value, "association-usage", used with these "proto" is required.
				It is defined in [<xref target="m-line"/>].
			</t>
			<t>
				As part of this registry, IANA maintains the following information:
			</t>
			<t>
				<list style='hanging'>
					<t hangText="association-usage name:">The identifier of the
					subprotocol, as will be used as the "fmt" value.</t>
					<t hangText="association-usage reference:">A reference to the
					document in which the association-usage is defined.</t>
				</list>
			</t>
			<t>
				association-usage names are to be subject to the "First Come First Served"
				IANA registration policy [RFC5226].
			</t>
			<t>
				IANA is asked to add initial values to the registry.
			</t>
			<figure anchor="exempleIANA" title="">
				<artwork><![CDATA[

     |----------------------------------------------------------|
     |         name       |           Reference                 |
     |----------------------------------------------------------|
     | webrtc-datachannel | draft-ietf-rtcweb-data-protocol-xx  |
     |----------------------------------------------------------|

	[RFC EDITOR NOTE: Please hold the publication of this draft
  until draft-ietf-rtcweb-data-protocol has been published as an RFC.
  Then, replace the reference to draft-ietf-rtcweb-data-protocol
	with the RFC number.]

				]]></artwork>
			</figure>
		</section>
	</section>

	<section title="Acknowledgments">
		<t>
			The authors wish to thank Harald Alvestrand, Randell Jesup, Paul Kyzivat,
			Michael Tuexen, Juergen Stoetzer-Bradler, Flemming Andreasen and Ari Keranen for
			their comments and useful feedback.
		</t>
	</section>

	<section title="">
		<t>[RFC EDITOR NOTE: Please remove this section when publishing]</t>
    <t>Changes from draft-ietf-mmusic-sctp-sdp-17
			<list style="symbols">
        <t>Removal of 'SCTP'.</t>
        <t>Document title changed.</t>
        <t>Disallow usage of SDP 'setup' attribute 'holdconn' value.</t>
				<t>Roman Shpount added as co-editor.</t>
			</list>
		</t>
    <t>Changes from draft-ietf-mmusic-sctp-sdp-15
			<list style="symbols">
				<t>Chapter about SCTP, DTLS and TCP association/connection management modified.</t>
        <t>Removal of SCTP/DTLS.</t>
			</list>
		</t>
		<t>Changes from draft-ietf-mmusic-sctp-sdp-14
			<list style="symbols">
				<t>Changes based on WGLC comments from Magnus Westerlund.</t>
				<t>- ABNF clarification that token and port are defined in RFC4566.</t>
				<t>- Specify 40 as maximum digit character length for the SDP max-message-size value.</t>
				<t>- Editorial clarification.</t>
				<t>Changes based on discussions at IETF#92.</t>
				<t>- Specify that all ICE candidate pairs belong to the same DTLS association.</t>
			</list>
		</t>
		<t>Changes from draft-ietf-mmusic-sctp-sdp-13
			<list style="symbols">
				<t>Changes based on comments from Paul Kyzivat.</t>
				<t>- Text preventing usage of well-known ports removed.</t>
				<t>- Editorial clarification.</t>
			</list>
		</t>
		<t>Changes from draft-ietf-mmusic-sctp-sdp-12
			<list style="symbols">
				<t>Mux category rules added for new SDP attributes.</t>
				<t>Reference to draft-ietf-mmusic-sdp-mux-attributes added.</t>
				<t>Changes based on comments from Roman Shpount:</t>
				<t>- Specify that fingerprint or setup roles must not be modified,
				unless underlying transport protocol is also modified.</t>
				<t>Changes based on comments from Ari Keranen:</t>
				<t>- Editorial corrections.</t>
				<t>Changes based on comments from Flemming Andreasen:</t>
				<t>- Clarify that, if UDP/DTLS/SCTP or TCP/DTLS/SCTP is used,
				     the DTLS association is established before the SCTP
					 association.</t>
				<t>- Clarify that max-message-size value is given in bytes, and
				     that different values can be used per direction.</t>
				<t>- Section on fmtp attribute removed.</t>
				<t>- Editorial corrections.</t>
			</list>
		</t>
		<t>Changes from draft-ietf-mmusic-sctp-sdp-11
			<list style="symbols">
				<t>Example added.</t>
			</list>
		</t>
		<t>Changes from draft-ietf-mmusic-sctp-sdp-10
			<list style="symbols">
				<t>SDP max-message-size attribute added to IANA considerations.</t>
				<t>Changes based on comments from Paul Kyzivat:</t>
				<t>- Text about max message size removed from fmtp attribute section.</t>
			</list>
		</t>
		<t>Changes from draft-ietf-mmusic-sctp-sdp-09
			<list style="symbols">
				<t>'DTLS/SCTP' split into 'UDP/DTLS/SCTP' and 'TCP/DTLS/SCTP'</t>
				<t>Procedures for realizing UDP/DTLS/SCTP- and TCP/DTLS/SCTP transports added.</t>
			</list>
		</t>
		<t>Changes from draft-ietf-mmusic-sctp-sdp-08
			<list style="symbols">
				<t>Default SCTP port removed:</t>
				<t>- Usage of SDP sctp-port attribute mandatory.</t>
				<t>SDP max-message-size attribute defined:</t>
				<t>- Attribute definition.</t>
				<t>- SDP Offer/Answer procedures.</t>
				<t>Text about SDP direction attributes added.</t>
				<t>Text about TLS role determination added.</t>
			</list>
		</t>
	</section>
</middle>

<back>
	<references title="Normative References">
		<?rfc include="reference.RFC.2119"?>
		<?rfc include="reference.RFC.3264"?>
		<?rfc include="reference.RFC.4145"?>
		<?rfc include="reference.RFC.4289"?>
		<?rfc include="reference.RFC.4566"?>
		<?rfc include="reference.RFC.4571"?>
		<?rfc include="reference.RFC.4572"?>
		<?rfc include="reference.RFC.4960"?>
		<?rfc include="reference.RFC.5061"?>
		<?rfc include="reference.RFC.5226"?>
		<?rfc include="reference.RFC.5234"?>
		<?rfc include="reference.RFC.6347"?>
		<?rfc include="reference.RFC.6838"?>
    <?rfc include="reference.I-D.draft-ietf-mmusic-4572-update-05"?>
    <?rfc include="reference.I-D.draft-ietf-mmusic-dtls-sdp-14"?>
		<?rfc include="reference.I-D.draft-ietf-tsvwg-sctp-dtls-encaps-09"?>
		<?rfc include="reference.I-D.draft-ietf-mmusic-sdp-mux-attributes-13"?>
	</references>
	<references title="Informative References">
		<?rfc include="reference.RFC.0793"?>
		<?rfc include="reference.RFC.5245"?>
		<?rfc include="reference.RFC.6083"?>
		<?rfc include="reference.RFC.6544"?>
		<?rfc include="reference.RFC.6951"?>
		<?rfc include="reference.I-D.draft-ietf-behave-sctpnat-09"?>
	</references>
</back>
</rfc>
